---
import Header from "./Header.astro";
---

<style>
  #header {
    opacity: 0;
    transition: opacity 0.5s ease-in-out;
    z-index: 50;
  }

  #header.opacity-100 {
    opacity: 1;
  }
</style>

<header
  id="header"
  class="fixed inset-x-0 top-[5vh] mx-auto w-[90%] opacity-0 transition-opacity duration-1000 md:top-[8vh]"
>
  <Header />
</header>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const chapterIntro = document.getElementById("chapter-intro") as HTMLElement;
    const header = document.getElementById("header") as HTMLElement;
    const scrollArrow = document.getElementById("scroll-arrow") as HTMLElement;

    if (chapterIntro && header && scrollArrow) {
      // HEADER FADE OBSERVER
      const headerObserver = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            if (!entry.isIntersecting) {
              header.classList.add("opacity-100"); // Fade in when scrolled past
              scrollArrow.classList.remove("opacity-100");
            } else {
              header.classList.remove("opacity-100"); // Fade out when back in view
              scrollArrow.classList.add("opacity-100"); // Fade out when back in view
            }
          });
        },
        { threshold: 0.1 },
      );

      headerObserver.observe(chapterIntro);
    } else {
      console.error("One or more elements were not found: chapterIntro, header, scrollArrow");
    }
  });
</script>
