---

interface Props {
    id: string,
    sectionClass?: string,
    extraClass?: string,
    fixedWrapperClass?: string,
};

const { 
    id, 
    extraClass = "",
    sectionClass = "section relative w-full min-h-screen",
    fixedWrapperClass = "fixed-wrapper fixed inset-x-0 bottom-0 w-[90%] h-[90%] mx-auto",
} = Astro.props;

---

<section 
    id={id} class=`${sectionClass}`>
    <div class=
        {`
            ${fixedWrapperClass}
            ${extraClass}
        `}>
        <slot />
    </div>
</section>

<script>
    
    // SECTIONS OBSERVER
    const sections = document.querySelectorAll('.section');
    const sectionsObserver = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
            const wrapper = entry.target.querySelector('.fixed-wrapper');
            if(wrapper) {
                if (entry.isIntersecting) {
                    wrapper.classList.add('show');

                } else {
                    wrapper.classList.remove('show');
                }
            }
        });
    }, { threshold: [0.5, 0.7] });

    sections.forEach((section) => sectionsObserver.observe(section));
</script>

<style is:global>

    .fixed-wrapper {
        opacity: 0;
        z-index: 0;
        transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
    }
    .show {
        opacity: 1;
        z-index: 10;
    }
</style>